<script type="text/javascript" charset="utf-8"> 
  var log = function(data){
  };
  var update = function(data){
    var task_card = $('#task_card_' + data.task_id);
    var container = task_card.parent();
    updateTaskCard(container, task_card, data.task_hours, data.task_devs, data.performed_by, '<%= current_user.name %>');
    notifyUser(data, "<%= current_user.name %>");
  };
  
  var jug = new Juggernaut({secure: ('https:' == document.location.protocol)});
  
  jug.on("connect", function(){ log("Connected") });
  jug.on("disconnect", function(){ log("Disconnected") });
  jug.on("reconnect", function(){ log("Reconnecting") });
  
  jug.subscribe("<%= uid %>", function(data){
    update(data);
  });
  
  // Expose for debugging
  window.jug = jug;
</script> 

